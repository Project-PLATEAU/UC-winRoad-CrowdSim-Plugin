# 人流シミュレーションプラグイン（UC-win/Roadプラグイン） 

![概要](./img/CrowdSimulatorPlugin.png) 

## 1. 概要 
本リポジトリでは、Project PLATEAUの令和6年度のユースケース開発業務の一部であるUC24-07「汎用的な人流シミュレーションシステム」について、その成果物である「人流シミュレーションプラグイン（UC-win/Roadプラグイン）」のソースコードを公開しています。

「人流シミュレーションプラグイン（UC-win/Roadプラグイン）」は、PLATEAUの3次元都市モデルを活用し、汎用フォーマット人流データ「MF-JSON」を用いた人流シミュレーション及びシミュレーション結果の出力を行うためのシステムです。

## 2. 「汎用的な人流シミュレーションシステム」について
「汎用的な人流シミュレーションシステム」では、都市開発、観光関連施策、イベント開催等での歩行空間設計や群衆制御といった分野において、企画立案・合意形成・効果検証等における人流シミュレーションの活用促進を目的として本システムを開発しました。
本リポジトリではは、汎用的な人流シミュレーションシステムに実装されたツールの一つである、歩行者の目的地や歩行速度等の初期条件、障害物や天候等の制約条件を設定することで人流シミュレーションや結果の解析・出力が可能な人流シミュレーションツールを公開しています。
本は、行政職員向けのGUIを備えたオープンソースソフトウェアとして開発されています。
本システムの詳細については[技術検証レポート](https://www.mlit.go.jp/plateau/file/libraries/doc/plateau_tech_doc_0102_ver01.pdf)を参照してください。

## 3. 利用手順
本システムの構築手順及び利用手順については[利用チュートリアル](https://project-plateau.github.io/UC-winRoad-CrowdSim-Plugin/)を参照してください。

## 4. システム概要

### 【シミュレーション条件設定】
#### ①人流データ読み込み機能
- 汎用フォーマット人流データを読み込みます。
- 断面交通流型の人流データを読み込むこともできます。断面交通流型の人流データは、シミュレーション計算時の歩行者の拡大推計に利用します。人感センサ「people-flow」のフォーマット、AIカメラ「FieldAnalyst forGateVer.8」のフォーマットに対応しています。

#### ②CityGML読み込み機能
- CityGMLを読み込みます。

#### ③歩行エリア生成・編集機能
- シミュレーションを実施する歩行エリアを生成します。
- 生成された歩行エリアについて、歩行可能・歩行不可等の状態を地点ごとに編集できます。

#### ④歩行者の行動設定機能
- 人流データから取得した歩行者の行動について、歩行速度や衝突半径等の条件を設定できます。

#### ⑤断面交通流計測機能
- 生成した歩行エリアの範囲内において、断面交通流の計測範囲を設定できます。
- ⑤によって設定された計測間隔ごとに計測範囲を通過した人数を記録・出力します。

#### ⑥集計設定機能
- 断面交通流の計測間隔や地点ごとの人流の集計間隔等、シミュレーションの集計条件を設定できます。

#### ⑦環境設定機能
- 日時や天候等、シミュレーション計算を行う環境を設定できます。

### シミュレーションの実行・可視化
#### ⑧シミュレーション計算機能
- 読み込んだ人流データと各種設定に基づいてシミュレーションを計算します。

#### ⑨シミュレーション可視化機能
- 計算されたシミュレーションを3次元ベースで可視化します。

### 【解析・出力】
#### ⑩シミュレーション結果解析・出力機能　
- シミュレーション結果を汎用フォーマット人流データで出力します。また、結果を解析し、画像やグラフで出力します。

## 5. 利用技術

| 種別        | 名称     | バージョン   | 内容                        |
| ----------- | --------|-------------|-----------------------------|
| ソフトウェア | [UC-win/Road](https://www.forum8.co.jp/product/ucwin/road/ucwin-road-1.htm) | 17.2.1 | 3次元リアルタイム・バーチャルリアリティソフト |
|             | [Delphi](https://www.embarcadero.com/jp/products/delphi) | 10.4.2 | 統合開発環境 |
| ライブラリ   | [UC-win/Road SDK](https://www.forum8.co.jp/product/ucwin/road/road-sdk.htm) | 17.0.0 | UC-win/Roadのカスタマイズ用API |
|             | [OpenGL](https://www.opengl.org/) | 4.6 | 3次元描画のためのグラフィックスAPI |
|             | [Menge](https://github.com/MengeCrowdSim/Menge) | 0.9.1 | 人流シミュレーション用の強力なクロスプラットフォームのモジュール式フレームワーク（シミュレーション計算に使用） |
|             | [MF-JSON](https://docs.ogc.org/is/19-045r3/19-045r3.html) | なし | 3次元形状の物体の移動データをJSONを用いて記述する簡潔な記述形式 |

## 6. 動作環境 <!-- 動作環境についての仕様を記載ください。 -->
| 項目               | 最小動作環境                            | 推奨動作環境                                  | 
| ------------------ | -------------------------------------- | ------------------------------------------- | 
| OS                 | Microsoft Windows 10 または 11（64bit） | 同左                                        | 
| CPU                | Intel Core i5以上                      | 同左                                         | 
| GPU                | NVIDIA製GPU                            | NVIDIA Geforce GTX1650以上（4GB以上のメモリ） | 
| メモリ          　  | 4GB以上                                | 32GB以上                                    | 
| ストレージ          | 最低30GB以上の空き容量                  | SSDドライブ<br>最低60GB以上の空き容量          | 
| ディスプレイ解像度   | 1920×1080以上                          | 同左          　　　　　　　　               | 
| ネットワーク        | 必須                                   | 同左                                        | 

## 7. 本リポジトリのフォルダ構成
| フォルダ名        |　詳細  |
|------------------|-------|
| src/F8CrowdSimPlugin | UC-win/Roadプラグインのソースコード |
| src/CrowdSim         | シミュレーション計算実行ソフトのソースコード |

## 8. ライセンス

- ソースコード及び関連ドキュメントの著作権は国土交通省に帰属します。
- 本ドキュメントは[Project PLATEAUのサイトポリシー](https://www.mlit.go.jp/plateau/site-policy/)（CCBY4.0及び公共データ利用規約第1.0版）に従い提供されています。

## 9. 注意事項

- 本リポジトリは参考資料として提供しているものです。動作保証は行っていません。
- 本リポジトリについては予告なく変更又は削除をする可能性があります。
- 本リポジトリの利用により生じた損失及び損害等について、国土交通省はいかなる責任も負わないものとします。

## 10. 参考資料
- 技術検証レポート: https://www.mlit.go.jp/plateau/file/libraries/doc/plateau_tech_doc_0102_ver01.pdf
- PLATEAU WebサイトのUse caseページ「汎用的な人流シミュレーションシステム」: https://www.mlit.go.jp/plateau/use-case/uc24-07/
